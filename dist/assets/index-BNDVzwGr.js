(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function e(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=e(o);fetch(o.href,s)}})();class c{constructor(){this.cart=this.loadFromStorage(),this.STORAGE_KEY="ouab_cart_items",this.initializeCart()}loadFromStorage(){try{const t=localStorage.getItem(this.STORAGE_KEY);return t?JSON.parse(t):[]}catch(t){return console.error("Erro ao carregar carrinho:",t),[]}}saveToStorage(){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(this.cart))}catch(t){console.error("Erro ao salvar carrinho:",t)}}calculateTotal(){return this.cart.reduce((t,e)=>t+e.price*(e.quantity||1),0)}getTotalItems(){return this.cart.reduce((t,e)=>t+(e.quantity||1),0)}findItem(t){return this.cart.filter(e=>e.id===t)[0]}removeItem(t){this.cart=this.cart.filter(e=>e.id!==t),this.saveToStorage(),this.updateDisplay()}updateQuantity(t,e){if(e<=0){this.removeItem(t);return}this.cart=this.cart.map(r=>r.id===t?{...r,quantity:e}:r),this.saveToStorage(),this.updateDisplay()}addItem(t){const e=this.findItem(t.id);e?this.updateQuantity(t.id,(e.quantity||1)+1):(this.cart.push({...t,quantity:1}),this.saveToStorage(),this.updateDisplay())}renderCartItems(){const t=document.getElementById("cartItems");if(!t)return;if(this.cart.length===0){t.innerHTML=`
                <div class="text-center py-12 text-[#655548]">
                    <i class="fas fa-shopping-cart text-[#cc9fa4] text-5xl mb-4"></i>
                    <p>Seu carrinho está vazio</p>
                </div>
            `;return}const e=this.cart.map(r=>`
            <div class="cart-item flex items-center gap-4 p-4 border-b border-[#e4d6d8]">
                <img src="${r.image}" alt="${r.title}" class="w-12 h-16 object-cover rounded">
                <div class="flex-1">
                    <h4 class="text-[#8a7462] font-semibold text-sm">${r.title}</h4>
                    <p class="text-[#655548] text-xs">${r.author}</p>
                    <div class="flex items-center gap-2 mt-2">
                        <button onclick="enhancedCartManager.updateQuantity(${r.id}, ${(r.quantity||1)-1})" 
                                class="w-6 h-6 bg-[#e4d6d8] text-[#8a7462] rounded flex items-center justify-center text-sm hover:bg-[#cc9fa4] hover:text-white transition-colors">-</button>
                        <span class="text-[#8a7462] font-semibold px-2">${r.quantity||1}</span>
                        <button onclick="enhancedCartManager.updateQuantity(${r.id}, ${(r.quantity||1)+1})" 
                                class="w-6 h-6 bg-[#cc9fa4] text-white rounded flex items-center justify-center text-sm hover:bg-[#a67a80] transition-colors">+</button>
                    </div>
                    <p class="text-[#8a7462] font-bold mt-1">R$ ${(r.price*(r.quantity||1)).toFixed(2).replace(".",",")}</p>
                </div>
                <button onclick="enhancedCartManager.removeItem(${r.id})" 
                        class="text-red-500 hover:text-red-700 p-2 transition-colors">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        `).join("");t.innerHTML=e}updateDisplay(){this.renderCartItems(),this.updateCounter(),this.updateTotal()}updateCounter(){const t=document.getElementById("cartCount");t&&(t.textContent=this.getTotalItems())}updateTotal(){const t=document.getElementById("cartTotal");if(t){const e=this.calculateTotal();t.textContent=e.toFixed(2).replace(".",",")}}getCartStats(){const t={};return this.cart.filter(e=>e.quantity>0).forEach(e=>{t[e.category]=(t[e.category]||0)+e.quantity}),{totalItems:this.getTotalItems(),totalValue:this.calculateTotal(),categories:t,uniqueBooks:this.cart.length}}clearCart(){this.cart=[],this.saveToStorage(),this.updateDisplay()}initializeCart(){this.updateDisplay()}exportCartData(){return{items:this.cart,stats:this.getCartStats(),timestamp:new Date().toISOString()}}}class g{constructor(){this.STORAGE_KEYS={REGISTRATION:"ouab_registration_data",CONTACT:"ouab_contact_data",PREFERENCES:"ouab_user_preferences"},this.initializeForms()}saveFormData(t,e){try{const r=this.STORAGE_KEYS[t.toUpperCase()];if(r)return localStorage.setItem(r,JSON.stringify({...e,timestamp:new Date().toISOString()})),!0}catch(r){console.error("Erro ao salvar dados do formulário:",r)}return!1}loadFormData(t){try{const e=this.STORAGE_KEYS[t.toUpperCase()];if(e){const r=localStorage.getItem(e);return r?JSON.parse(r):null}}catch(e){console.error("Erro ao carregar dados do formulário:",e)}return null}extractFormData(t){return new FormData(t),[...t.querySelectorAll("input, textarea, select")].reduce((r,o)=>{if(o.type==="checkbox")r[o.name||o.placeholder.toLowerCase().replace(/\s+/g,"_")]=o.checked;else if(o.type!=="submit"&&o.type!=="button"){const s=o.name||o.placeholder.toLowerCase().replace(/\s+/g,"_");r[s]=o.value}return r},{})}fillFormFields(t,e){if(!e)return;t.querySelectorAll("input, textarea, select").forEach(o=>{const s=o.name||o.placeholder.toLowerCase().replace(/\s+/g,"_");e[s]!==void 0&&(o.type==="checkbox"?o.checked=e[s]:o.type!=="submit"&&o.type!=="button"&&(o.value=e[s]))})}setupAutoSave(t,e){t.querySelectorAll("input, textarea").forEach(o=>{o.addEventListener("input",()=>{const s=this.extractFormData(t);this.saveFormData(e,s)})})}setupRegistrationForm(){const t=document.querySelector("form:not(#formContato)");if(!t)return;const e=t.querySelectorAll("input"),r=["nome","email","senha","confirmar_senha","aceito_termos","receber_ofertas"];e.forEach((s,i)=>{i<r.length&&(s.name=r[i])});const o=this.loadFormData("REGISTRATION");this.fillFormFields(t,o),this.setupAutoSave(t,"REGISTRATION"),t.addEventListener("submit",s=>{s.preventDefault();const i=this.extractFormData(t);if(i.senha!==i.confirmar_senha){alert("As senhas não coincidem!");return}if(!i.aceito_termos){alert("Você deve aceitar os termos de uso!");return}this.saveFormData("REGISTRATION",{...i,status:"completed",completedAt:new Date().toISOString()}),this.showRegistrationSuccess()})}setupContactForm(){const t=document.getElementById("formContato");if(!t)return;const e=t.querySelectorAll("input, textarea"),r=["nome","email","mensagem"];e.forEach((s,i)=>{i<r.length&&(s.name=r[i])});const o=this.loadFormData("CONTACT");this.fillFormFields(t,o),this.setupAutoSave(t,"CONTACT"),t.removeEventListener("submit",this.originalContactHandler),t.addEventListener("submit",s=>{s.preventDefault();const i=this.extractFormData(t);this.saveFormData("CONTACT",{...i,status:"sent",sentAt:new Date().toISOString()}),t.classList.add("hidden"),document.getElementById("mensagemAgradecimento").classList.remove("hidden"),setTimeout(()=>{t.reset(),t.classList.remove("hidden"),document.getElementById("mensagemAgradecimento").classList.add("hidden"),localStorage.removeItem(this.STORAGE_KEYS.CONTACT)},3e3)})}showRegistrationSuccess(){const t=document.querySelector("form:not(#formContato)"),e=t.innerHTML;t.innerHTML=`
            <div class="text-center py-12">
                <i class="fas fa-check-circle text-green-500 text-6xl mb-4"></i>
                <h3 class="text-[#8a7462] text-2xl font-bold mb-4">Conta Criada com Sucesso!</h3>
                <p class="text-[#655548] mb-6">Bem-vindo à nossa livraria online!</p>
                <button onclick="location.reload()" class="bg-[#cc9fa4] text-white px-6 py-3 rounded-lg hover:bg-[#a67a80] transition-colors">
                    Fazer Login
                </button>
            </div>
        `,setTimeout(()=>{t.innerHTML=e,this.setupRegistrationForm()},5e3)}getFormStats(){const t=this.loadFormData("REGISTRATION"),e=this.loadFormData("CONTACT"),r={hasRegistration:!!t,hasContactHistory:!!e,registrationComplete:(t==null?void 0:t.status)==="completed",lastActivity:null},o=[t,e].filter(s=>s&&s.timestamp).map(s=>new Date(s.timestamp));return o.length>0&&(r.lastActivity=new Date(Math.max(...o))),r}clearAllFormData(){Object.values(this.STORAGE_KEYS).forEach(t=>{localStorage.removeItem(t)})}initializeForms(){document.addEventListener("DOMContentLoaded",()=>{this.setupRegistrationForm(),this.setupContactForm()})}exportAllData(){const t={};return Object.entries(this.STORAGE_KEYS).forEach(([e,r])=>{t[e.toLowerCase()]=this.loadFormData(e)}),{forms:t,stats:this.getFormStats(),exportedAt:new Date().toISOString()}}}const h=[{id:1,title:"Amor Teoricamente",author:" Ali Hazelwood",price:39.9,category:"romance",image:"./src/assets/img/amor-teoricamente.jpeg",rating:4.5,description:"Romance universitário."},{id:2,title:"Orgulho e Preconceito",author:"Jane Austen",price:45.5,category:"romance",image:"./src/assets/img/orgulho-e-preconceito.jpeg",rating:5,description:"O clássico romance que conquistou gerações."},{id:3,title:"Uma Janela Sombria",author:"Rachel Gillig",price:52.9,category:"fantasia",image:"./src/assets/img/uma-janela-sombria.jpeg",rating:4,description:"Um fantasia envolvente cheio de mistérios."},{id:4,title:"De Sangue e Cinzas",author:"Jennifer L. Armentrout",price:35.9,category:"fantasia",image:"./src/assets/img/de-sangue-e-cinzas.jpeg",rating:5,description:"O início de uma saga famosa e espetacular."},{id:5,title:"Quarta Asa",author:"Rebecca Yarros",price:89.9,category:"fantasia",image:"./src/assets/img/quarta-asa.jpeg",rating:4.8,description:"A épica jornada pelo Instituto Basgiath."},{id:6,title:"Uma Vida e Tanto",author:"Emily Henry",price:42.9,category:"ficção",image:"./src/assets/img/uma-vida-e-tanto.jpeg",rating:4.3,description:"O mais novo da rainha do romance."},{id:7,title:"Verity",author:"Colleen Hoover",price:38.9,category:"misterio",image:"./src/assets/img/verity.jpeg",rating:4.2,description:"Um thriller psicológico perturbador."},{id:8,title:"Era Uma Vez um Coração Partido",author:"Stephanie Meyer",price:55.9,category:"fantasia",image:"./src/assets/img/era-uma-vez-um-coracao-partido.jpeg",rating:4.6,description:"Uma história de amor emocionante."},{id:9,title:"Os Sete Maridos de Evelyn Hugo",author:"Taylor Jenkins Reid",price:48.9,category:"ficção",image:"./src/assets/img/os-sete-maridos-de-evelyn-hugo.jpeg",rating:4.9,description:"A fascinante vida de uma lenda de Hollywood."}];let n={books:h,filteredBooksCache:new Map,currentFilter:"all",cartManager:new c,formManager:new g};function m(){const a=n.cartManager.getTotalItems();if(console.log("Cart Items:",a),a.length===0){alert("Seu carrinho está vazio. Adicione itens antes de finalizar a compra.");return}alert("Compra finalizada com sucesso! Obrigado por comprar conosco."),n.cartManager.clearCart(),console.log("Cart cleared."),l()}function f(a){if(n.filteredBooksCache.has(a))return n.filteredBooksCache.get(a);let t;return a==="all"?t=[...n.books]:t=n.books.filter(e=>e.category===a),n.filteredBooksCache.set(a,t),t}function l(a="all"){const t=document.getElementById("booksGrid"),e=f(a);t.innerHTML="",e.map((o,s)=>p(o,s)).forEach(o=>{t.appendChild(o)}),b()}function p(a,t){const e=document.createElement("div");e.className="book-item bg-[#f7f6f4] border-2 border-[#e4d6d8] rounded-2xl p-6 overflow-hidden transition-all duration-300 hover:border-[#cc9fa4] hover:bg-[#ede3e5] opacity-0 transform translate-y-8 flex flex-col h-full",e.setAttribute("data-category",a.category),e.style.transitionDelay=`${t*100}ms`;const r=y(a.rating);return e.innerHTML=`
        <div class="flex justify-center mb-4">
            <img src="${a.image}" alt="${a.title}" 
                 class="w-28 h-36 object-cover rounded-xl shadow-lg"
                 onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjE2MCIgdmlld0JveD0iMCAwIDEyOCAxNjAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMjgiIGhlaWdodD0iMTYwIiBmaWxsPSIjRTVFN0VCIi8+CjxwYXRoIGQ9Ik00NCA2NEg4NFY5Nkg0NFY2NFoiIGZpbGw9IiM5Q0EzQUYiLz4KPHN2Zz4K'; this.onerror=null;">
        </div>
        <div class="flex-grow">
            <h3 class="text-[#8a7462] text-lg font-bold mb-2 line-clamp-2">${a.title}</h3>
            <p class="text-[#655548] text-sm mb-2">${a.author}</p>
            <p class="text-[#655548] text-xs mb-3 opacity-75 line-clamp-2">${a.description}</p>
        </div>
        <div class="mt-auto">
            <div class="flex justify-between items-center mb-4">
                <span class="text-[#8a7462] font-bold">R$ ${a.price.toFixed(2).replace(".",",")}</span>
                <div class="flex text-yellow-400 text-sm">
                    ${r}
                </div>
            </div>
            <button onclick="addToCart(${a.id})" 
                    class="w-full bg-[#cc9fa4] text-white py-2 rounded-lg hover:bg-[#a67a80] transition-colors duration-300 transform hover:scale-105 text-sm font-medium">
                Adicionar ao Carrinho
            </button>
        </div>
    `,e}function y(a){const t=Math.floor(a),e=a%1!==0,r=5-t-(e?1:0);let o="";for(let s=0;s<t;s++)o+='<i class="fas fa-star"></i>';e&&(o+='<i class="fas fa-star-half-alt"></i>');for(let s=0;s<r;s++)o+='<i class="far fa-star"></i>';return o}function b(){return[...document.querySelectorAll(".book-item")].map((r,o)=>setTimeout(()=>{r.classList.remove("opacity-0","translate-y-8"),r.classList.add("opacity-100","translate-y-0")},o*100))}function v(){const t=[...document.querySelectorAll(".filter-btn")];return t.map(r=>{const o=()=>{t.forEach(i=>{i.classList.remove("active","bg-[#cc9fa4]","text-white","border-[#cc9fa4]"),i.classList.add("bg-[#ede3e5]","text-[#8a7462]","border-[#e4d6d8]")}),r.classList.add("active","bg-[#cc9fa4]","text-white","border-[#cc9fa4]"),r.classList.remove("bg-[#ede3e5]","text-[#8a7462]","border-[#e4d6d8]");const s=r.getAttribute("data-category");n.currentFilter=s,l(s)};return r.addEventListener("click",o),{button:r,handler:o}})}function x(a){const t=n.books.find(e=>e.id===a);t&&(n.cartManager.addItem(t),S(a))}function S(a){const t=document.querySelector(`button[onclick="addToCart(${a})"]`);if(t){const e=t.textContent;t.textContent="Adicionado!",t.classList.add("bg-green-500","hover:bg-green-600"),t.classList.remove("bg-[#cc9fa4]","hover:bg-[#a67a80]"),setTimeout(()=>{t.textContent=e,t.classList.remove("bg-green-500","hover:bg-green-600"),t.classList.add("bg-[#cc9fa4]","hover:bg-[#a67a80]")},2e3)}}function C(){l(),v()}function E(){const a=document.getElementById("cartSidebar");a.classList.toggle("translate-x-0"),a.classList.toggle("translate-x-full")}window.addToCart=x;window.toggleCart=E;window.finalizePurchase=m;window.enhancedCartManager=n.cartManager;document.addEventListener("DOMContentLoaded",function(){C();const a=document.getElementById("finalizePurchaseButton");a?(console.log("Finalize button found, adding event listener"),a.onclick=function(){console.log("Finalizar Compra button clicked"),m()}):console.error("Finalizar Compra button not found")});const d=document.getElementById("hamburger"),u=document.getElementById("mobileMenu");document.getElementById("hamburger").addEventListener("click",function(){document.getElementById("mobileMenu").classList.toggle("-translate-x-full")});document.querySelectorAll("#mobileMenu a").forEach(a=>{a.addEventListener("click",()=>{document.getElementById("mobileMenu").classList.add("-translate-x-full")})});d.addEventListener("click",()=>{const a=d.querySelectorAll("span");a[0].classList.toggle("rotate-45"),a[0].classList.toggle("translate-y-2"),a[1].classList.toggle("opacity-0"),a[2].classList.toggle("-rotate-45"),a[2].classList.toggle("-translate-y-2"),u.classList.toggle("-translate-x-full"),u.classList.toggle("translate-x-0")});document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(t){t.preventDefault();const e=document.querySelector(this.getAttribute("href"));e&&e.scrollIntoView({behavior:"smooth"})})});document.querySelectorAll(".filter-btn").forEach(a=>{a.addEventListener("click",()=>{document.querySelectorAll(".filter-btn").forEach(t=>{t.classList.remove("bg-dark-pink","text-white","border-dark-pink"),t.classList.add("bg-light-pink","text-primary-brown","border-primary-pink")}),a.classList.remove("bg-light-pink","text-primary-brown","border-primary-pink"),a.classList.add("bg-dark-pink","text-white","border-dark-pink")})});new c;document.addEventListener("DOMContentLoaded",()=>{const a=new c,t=document.getElementById("finalizarCompra");t&&t.addEventListener("click",()=>{a.cart.length===0?alert("Seu carrinho está vazio."):(alert("Compra finalizada com sucesso!"),a.clearCart())})});
